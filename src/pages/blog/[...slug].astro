---
import { type CollectionEntry, getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Navigation from "../../components/Navigation.astro";
import Footer from "../../components/Footer.astro";

export async function getStaticPaths() {
	const posts = await getCollection("blog");
	return posts.map((post) => ({
		params: { slug: post.id },
		props: post,
	}));
}

type Props = CollectionEntry<"blog">;

const post = Astro.props;
const { Content } = await render(post);

function formatDate(date: Date) {
	return date.toLocaleDateString("en-US", {
		year: "numeric",
		month: "long",
		day: "numeric",
	});
}
---

<Layout title={post.data.title} description={post.data.description}>
	<Navigation />

	<article class="container py-5">
		<header class="row mb-5">
			<div class="col-lg-8 mx-auto text-center">
				<h1 class="display-4 fw-bold brand-text mb-3">
					{post.data.title}
				</h1>
				<p class="lead text-muted mb-4">{post.data.description}</p>
				<div
					class="d-flex justify-content-center align-items-center gap-3 text-muted"
				>
					<time datetime={post.data.pubDate.toISOString()}>
						{formatDate(post.data.pubDate)}
					</time>
				</div>
			</div>
		</header>

		{
			post.data.heroImage && (
				<div class="row mb-5">
					<div class="col-12">
						<img
							src={post.data.heroImage.src}
							alt={post.data.title}
							class="img-fluid rounded shadow w-100"
							style="height: 400px; object-fit: cover;"
						/>
					</div>
				</div>
			)
		}

		<div class="row">
			<div class="col-lg-8 mx-auto">
				<div class="prose prose-lg">
					<Content />
				</div>
			</div>
		</div>

		<div class="row mt-5">
			<div class="col-lg-8 mx-auto text-center">
				<a href="/blog" class="btn btn-outline-primary">
					‚Üê Back to Blog
				</a>
			</div>
		</div>
	</article>

	<Footer />
</Layout>
