---
export interface Props {
    name: string;
    category: string;
    description: string;
    image: string;
    website: string;
    phone?: string;
    address?: string;
    petFriendly?: boolean;
    priceRange?: '$' | '$$' | '$$$' | '$$$$';
}

const {
    name,
    category,
    description,
    image,
    website,
    phone,
    address,
    petFriendly = false,
    priceRange,
} = Astro.props;

const placeholderImage = 'https://placehold.co/600x250/4a90e2/ffffff?text=' + encodeURIComponent(name);
---

<div class="col-lg-6">
    <div class="card h-100 shadow-lg border-0">
        <div class="image-container">
            <img
                src={image}
                class="card-img-top restaurant-logo"
                alt={name}
                loading="lazy"
                width="600"
                height="250"
            />
        </div>
        <div class="card-body d-flex flex-column">
            <h3 class="card-title h4 fw-bold">{name}</h3>
            <p class="text-muted mb-2">
                <small>{category}</small>
                {priceRange && <span class="ms-2">{priceRange}</span>}
            </p>
            <p class="card-text">{description}</p>

            {(phone || address || petFriendly) && (
                <div class="border-top border-bottom py-3 my-3">
                    {address && (
                        <div class="mb-2">
                            <small>
                                <i class="fas fa-map-marker-alt"></i> {address}
                            </small>
                        </div>
                    )}
                    {phone && (
                        <div class="mb-2">
                            <small>
                                <i class="fas fa-phone"></i> {phone}
                            </small>
                        </div>
                    )}
                    {petFriendly && (
                        <div>
                            <small class="text-success">
                                <i class="fas fa-check-circle"></i> Pet Friendly <i class="fas fa-paw"></i>
                            </small>
                        </div>
                    )}
                </div>
            )}

            <div class="mt-auto">
                <a href={website} target="_blank" rel="noopener noreferrer" class="btn btn-brand btn-lg w-100">
                    Visit Website
                </a>
            </div>
        </div>
    </div>
</div>

<style>
    .image-container {
        height: 250px;
        background-color: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }

    .restaurant-logo {
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        object-fit: contain;
    }
</style>

<script define:vars={{ image, placeholderImage }}>
    // Find the image within the current component
    const container = document.currentScript.closest('.col-lg-6');
    const img = container?.querySelector('.restaurant-logo');
    if (img) {
        img.addEventListener('error', function() {
            this.src = placeholderImage;
        });
    }
</script>
